---
ansible_connection: httpapi
module_name: tacacs_pki

preparations_tests:
  delete_pki:
    - name: delete_all
      description: Delete PKI
      state: deleted
      input:
tests:
  - name: test_case_01
    description: Add new PKI configuration
    state: merged
    input:
      security-profiles:
        - profile-name: mysp
        - profile-name: myspb
          ocsp-responder-list:
            - http://localhost/ocsp
      trust-stores:
        - name: myts
          ca-name: CA2

  - name: test_case_02
    description: Update specific params of security-profile
    state: merged
    input:
      security-profiles:
        - profile-name: mysp
          cdp-list:
            - http://example.com/cdp
          trust-store: myts
          revocation-check: False
  - name: test_case_03
    description: Delete specific params of security-profile
    state: deleted
    input:
      security-profiles:
        - profile-name: mysp
          cdp-list:
            - http://example.com/cdp
  - name: test_case_04
    description: Delete all security-profiles configurations
    state: deleted
    input:
      security-profiles:
#  - name: test_case_05
#    description: Merge parameter of tacacs servers
#    state: merged
#    input:
#      servers:
#        host:
#          - name: my_host
#            auth_type: chap
#            port: 55
#            timeout: 12
#            priority: 3
#          - name: my_host1
#            auth_type: login
#            port: 60
#            timeout: 14
#            priority: 4
#          - name: my_host2
#            auth_type: login
#            port: 60
#            timeout: 14
#            priority: 4
#
#  - name: test_case_06
#    description: Replace some parameter of tacacs servers
#    state: replaced
#    input:
#      auth_type: mschap
#      source_interface: "{{ interface3 }}"
#      timeout: 36
#      servers:
#        host:
#          - name: my_host
#            auth_type: chap
#            port: 55
#            timeout: 12
#            priority: 3
#
#  - name: test_case_07
#    description: Replace hosts of tacacs servers
#    state: replaced
#    input:
#      auth_type: mschap
#      source_interface: "{{ interface3 }}"
#      timeout: 36
#      servers:
#        host:
#          - name: my_host
#            auth_type: chap
#            port: 55
#            timeout: 12
#            priority: 3
#          - name: 20.21.22.23
#            auth_type: login
#            port: 50
#            timeout: 38
#            priority: 4
#          - name: 18.21.22.23
#            auth_type: chap
#            port: 20
#            timeout: 19
#            priority: 8
#
#  - name: test_case_08
#    description: Override parameter of tacacs servers
#    state: overridden
#    input:
#      auth_type: chap
#      source_interface: "{{ interface2 }}"
#      timeout: 20
#      servers:
#        host:
#          - name: 10.11.11.11
#            auth_type: pap
#            port: 55
#            timeout: 12
#            priority: 3
#          - name: your_host
#            auth_type: login
#            port: 50
#            timeout: 30
#            priority: 6
#
test_delete_all:
  - name: test_case_09
    description: Delete all PKI configurations
    state: deleted
